# Product Requirements Document (PRD)
# Engineering Calculator Web App

## 1. 프로젝트 개요

### 1.1 목적
현대적이고 직관적인 UI/UX를 갖춘 공학용 전자계산기 웹 애플리케이션을 개발하여, 사용자가 기본 산술 연산부터 고급 과학 함수까지 쉽게 사용할 수 있도록 합니다.

### 1.2 목표
- **사용자 경험**: 모바일 네이티브 앱과 같은 부드럽고 반응성 높은 인터페이스 제공
- **기능성**: 기본 계산기와 공학용 계산기 기능을 모두 지원
- **접근성**: 다크/라이트 모드를 지원하여 다양한 환경에서 사용 가능
- **확장성**: 향후 단위 변환, 계산 히스토리 등 추가 기능 확장 가능한 구조

### 1.3 타겟 사용자
- 학생 (중/고등학생, 대학생)
- 엔지니어 및 과학자
- 일반 사용자 (빠른 계산이 필요한 모든 사람)

---

## 2. 핵심 기능 (Core Features)

### 2.1 기본 계산 기능
- **산술 연산**: 덧셈(+), 뺄셈(-), 곱셈(×), 나눗셈(÷)
- **소수점 계산**: 정확한 부동소수점 연산
- **괄호 연산**: 복잡한 수식에서 우선순위 처리
- **백분율 계산**: % 연산자 지원

### 2.2 공학용 계산 기능
- **삼각함수**: sin, cos, tan (및 역함수)
- **각도 모드**: DEG (도) / RAD (라디안) 전환
- **지수/로그**: 거듭제곱, 제곱근, 로그 함수
- **상수**: π, e 등 수학 상수 지원

### 2.3 사용자 인터페이스
- **실시간 입력 표시**: 입력 중인 수식을 상단에 표시
- **결과 표시**: 큰 글씨로 명확한 결과 표시
- **천 단위 구분**: 숫자 가독성을 위한 쉼표 구분 (예: 12,500)
- **애니메이션**: 부드러운 페이드인 효과 및 버튼 피드백

### 2.4 추가 기능
- **계산 히스토리**: 이전 계산 내역 조회 (History 버튼)
- **단위 변환**: 길이, 무게, 온도 등 단위 변환 기능 (Unit 버튼)
- **설정**: 테마 변경, 소수점 자릿수 설정 등
- **다크/라이트 모드**: 시스템 설정 또는 수동 전환

---

## 3. 디자인 시스템

### 3.1 컬러 팔레트

#### Light Mode
- **Background**: `#f6f6f8` (연한 회색)
- **Surface**: `#ffffff` (흰색)
- **Primary**: `#135bec` (파란색)
- **Text Primary**: `#000000` (검정)
- **Text Secondary**: `#6b7280` (회색)

#### Dark Mode
- **Background**: `#101622` (진한 남색)
- **Surface**: `#1e2532` (어두운 회색)
- **Surface Variant**: `#161e2c` (키패드 배경)
- **Primary**: `#135bec` (파란색)
- **Text Primary**: `#ffffff` (흰색)
- **Text Secondary**: `#9ca3af` (연한 회색)
- **Accent**: `#1f293a` (연산자 버튼 배경)

### 3.2 타이포그래피
- **폰트 패밀리**: Space Grotesk (Google Fonts)
- **제목 (Scientific)**: 18px, Bold
- **입력 수식**: 20px, Normal
- **결과 표시**: 60px, Bold
- **버튼 텍스트**: 16-24px, Medium/Bold

### 3.3 레이아웃
- **헤더**: 상단 고정, 제목 중앙, 설정 버튼 우측
- **디스플레이 영역**: 중앙 정렬, 우측 정렬 텍스트
- **툴바**: History, Unit 버튼 좌측, DEG/RAD 토글 우측
- **키패드**: 4×6 그리드, 둥근 모서리 버튼

### 3.4 컴포넌트 스타일

#### 버튼 스타일
1. **숫자 버튼** (0-9, .)
   - 배경: 흰색 (라이트) / 반투명 회색 (다크)
   - 테두리: 연한 회색
   - 그림자: 미세한 shadow
   - 호버: 배경 밝기 변화
   - 액티브: scale(0.95) 애니메이션

2. **연산자 버튼** (+, -, ×, ÷)
   - 배경: 연한 파란색 (#blue-50 / #1f293a)
   - 텍스트: Primary 파란색
   - 크기: 24px, Bold

3. **기능 버튼** (AC, (), %)
   - 배경: 회색 (#gray-100 / #surface-dark)
   - AC: 빨간색 텍스트
   - 나머지: Primary 파란색 텍스트

4. **과학 함수 버튼** (sin, cos, tan)
   - 배경: 회색
   - 텍스트: 일반 회색 (다크 모드에서는 연한 회색)
   - 크기: 16px, Medium

5. **등호 버튼** (=)
   - 배경: Primary 파란색 (#135bec)
   - 텍스트: 흰색
   - 크기: 2행 span (세로로 길게)
   - 그림자: 파란색 glow 효과

#### 인터랙션
- **호버 효과**: 밝기 변화 (brightness-95/110)
- **클릭 효과**: scale(0.95) 트랜지션
- **트랜지션**: 모든 상태 변화에 0.3초 부드러운 전환

### 3.5 아이콘
- **Material Symbols Outlined** 사용
- 설정, 히스토리, 단위 변환, 백스페이스 등

---

## 4. 기술 스택

### 4.1 프론트엔드
- **HTML5**: 시맨틱 마크업
- **CSS3**: 
  - Tailwind CSS (유틸리티 우선 스타일링)
  - 커스텀 CSS (애니메이션, 특수 효과)
- **JavaScript (Vanilla)**: 
  - 계산 로직
  - UI 인터랙션
  - 상태 관리

### 4.2 외부 라이브러리
- **Google Fonts**: Space Grotesk 폰트
- **Material Symbols**: 아이콘 세트
- **Tailwind CSS CDN**: 빠른 프로토타이핑 (프로덕션에서는 빌드 버전 사용 권장)

### 4.3 계산 엔진
- **Math.js** (선택사항): 복잡한 수학 연산 처리
- 또는 **Vanilla JavaScript**: 기본 Math 객체 활용

---

## 5. 사용자 플로우

### 5.1 기본 계산 플로우
```
1. 사용자가 숫자 버튼 클릭
   ↓
2. 디스플레이에 입력 수식 표시
   ↓
3. 연산자 버튼 클릭
   ↓
4. 추가 숫자 입력
   ↓
5. = 버튼 클릭
   ↓
6. 결과 표시 (큰 글씨로)
```

### 5.2 과학 함수 사용 플로우
```
1. 각도 모드 선택 (DEG/RAD)
   ↓
2. 숫자 입력 (예: 45)
   ↓
3. 과학 함수 버튼 클릭 (예: sin)
   ↓
4. 수식 표시: sin(45)
   ↓
5. = 버튼 클릭
   ↓
6. 결과 표시: 0.707...
```

### 5.3 히스토리 조회 플로우
```
1. History 버튼 클릭
   ↓
2. 하단에서 히스토리 패널 슬라이드 업
   ↓
3. 이전 계산 목록 표시
   ↓
4. 항목 클릭 시 해당 수식 재사용
   ↓
5. 드래그 핸들로 패널 닫기
```

---

## 6. 화면 구성

### 6.1 메인 화면 레이아웃

```
┌─────────────────────────────────┐
│  [뒤로]    Scientific    [설정]  │ ← Header
├─────────────────────────────────┤
│                                 │
│                                 │
│              12,500 + sin(45)   │ ← 입력 수식
│                  = 12,500.707   │ ← 결과
│                                 │
│              ─────              │ ← 드래그 핸들
├─────────────────────────────────┤
│ [History] [Unit]      [DEG|RAD] │ ← 툴바
├─────────────────────────────────┤
│  AC   ()    %     ÷             │
│  sin  cos   tan   ×             │
│  7    8     9     -             │
│  4    5     6     +             │
│  1    2     3     ║             │
│  0    .    ⌫      ║  =          │
└─────────────────────────────────┘
```

### 6.2 반응형 디자인
- **모바일 우선**: 320px ~ 480px 최적화
- **태블릿**: 481px ~ 768px (버튼 크기 증가)
- **데스크톱**: 769px 이상 (최대 너비 제한, 중앙 정렬)

---

## 7. 주요 기능 명세

### 7.1 계산 로직

#### 입력 처리
- 연속된 숫자 입력 → 문자열 결합
- 소수점 중복 입력 방지
- 연산자 연속 입력 시 마지막 연산자만 유효
- 괄호 균형 검사

#### 연산 우선순위
1. 괄호 내부
2. 과학 함수 (sin, cos, tan 등)
3. 거듭제곱
4. 곱셈, 나눗셈
5. 덧셈, 뺄셈

#### 에러 처리
- **0으로 나누기**: "Error: Division by zero"
- **잘못된 수식**: "Syntax Error"
- **범위 초과**: "Overflow"
- **정의되지 않은 값**: "Undefined"

### 7.2 디스플레이 형식
- **정수**: 천 단위 쉼표 구분 (12,500)
- **소수**: 최대 10자리까지 표시
- **과학적 표기법**: 10^15 이상 또는 10^-6 이하
- **자동 반올림**: 부동소수점 오차 보정

### 7.3 키보드 지원
- **숫자 키**: 0-9
- **연산자**: +, -, *, /
- **Enter**: = (계산 실행)
- **Backspace**: 마지막 문자 삭제
- **Escape**: AC (전체 삭제)
- **( )**: 괄호 입력

---

## 8. 데이터 모델

### 8.1 상태 관리

```javascript
const calculatorState = {
  currentInput: "",        // 현재 입력 중인 값
  previousInput: "",       // 이전 입력 값
  operation: null,         // 현재 연산자
  displayValue: "0",       // 디스플레이에 표시할 값
  history: [],             // 계산 히스토리
  angleMode: "DEG",        // 각도 모드 (DEG/RAD)
  memory: 0,               // 메모리 저장 값
  isResultDisplayed: false // 결과 표시 상태
};
```

### 8.2 히스토리 데이터 구조

```javascript
const historyItem = {
  id: "uuid",
  expression: "12,500 + sin(45)",
  result: "12,500.707",
  timestamp: "2025-12-23T16:00:00Z",
  angleMode: "DEG"
};
```

---

## 9. 성능 요구사항

### 9.1 응답 시간
- **버튼 클릭 반응**: < 50ms
- **계산 실행**: < 100ms (일반 연산)
- **과학 함수 계산**: < 200ms
- **페이지 로드**: < 2초 (3G 네트워크)

### 9.2 최적화
- **CSS 애니메이션**: GPU 가속 (transform, opacity 사용)
- **이벤트 디바운싱**: 연속 입력 최적화
- **레이지 로딩**: 히스토리 패널 필요 시 로드
- **로컬 스토리지**: 히스토리 및 설정 저장 (최대 5MB)

---

## 10. 접근성 (Accessibility)

### 10.1 WCAG 2.1 준수
- **AA 등급** 목표
- **색상 대비**: 최소 4.5:1 (텍스트)
- **키보드 네비게이션**: 모든 기능 키보드로 접근 가능
- **스크린 리더**: ARIA 레이블 적용

### 10.2 ARIA 속성
```html
<button aria-label="Number 7">7</button>
<button aria-label="Add">+</button>
<button aria-label="Calculate" aria-keyshortcut="Enter">=</button>
<div role="status" aria-live="polite">12,500.707</div>
```

---

## 11. 보안 및 프라이버시

### 11.1 데이터 보안
- **로컬 스토리지만 사용**: 서버 전송 없음
- **XSS 방지**: 입력 값 sanitization
- **CSP 헤더**: Content Security Policy 적용

### 11.2 프라이버시
- **개인정보 수집 없음**: 완전한 클라이언트 사이드 앱
- **쿠키 미사용**: 로컬 스토리지로 설정 저장
- **오프라인 지원**: PWA로 변환 가능

---

## 12. 테스트 계획

### 12.1 자동화 테스트 (TDD - 코어 로직만)

**테스트 범위**: 비즈니스 로직, 계산 엔진, 상태 관리, 데이터 처리
**테스트 제외**: UI 컴포넌트, DOM 조작, 시각적 요소

#### 단위 테스트
- **계산 로직 함수**
  - 기본 산술 연산 (덧셈, 뺄셈, 곱셈, 나눗셈)
  - 과학 함수 (sin, cos, tan, 각도 변환)
  - 거듭제곱, 제곱근, 로그 함수
- **수식 파서**
  - 토큰화 (tokenization)
  - AST 파싱
  - 수식 평가 (evaluation)
  - 연산자 우선순위
- **상태 관리**
  - StateManager 클래스
  - 상태 업데이트 로직
  - Observer 패턴
- **스토리지 관리**
  - localStorage 읽기/쓰기
  - 데이터 직렬화/역직렬화
  - 히스토리 관리
- **에러 처리**
  - 0으로 나누기
  - 구문 오류
  - 오버플로우
  - 잘못된 입력

#### 통합 테스트
- 전체 계산 플로우 (입력 → 파싱 → 계산 → 결과)
- 히스토리 저장 및 불러오기
- 테마 설정 저장/복원
- 각도 모드 전환 로직

**목표**: 코어 로직 코드 커버리지 >80%

### 12.2 수동 테스트 (UI/UX)

**테스트 방법**: 실제 브라우저에서 수동 검증

#### UI 인터랙션 테스트
- 버튼 클릭 반응성 및 피드백
- 애니메이션 부드러움
- 호버 효과 및 액티브 상태
- 터치 인터랙션 (모바일)

#### 반응형 디자인 테스트
- 다양한 화면 크기 (320px ~ 1920px)
- 모바일, 태블릿, 데스크톱 레이아웃
- 세로/가로 모드 전환

#### 테마 테스트
- 다크/라이트 모드 전환
- 색상 대비 확인
- 시스템 테마 자동 감지

#### 키보드 입력 테스트
- 숫자 키 입력
- 연산자 키 입력
- Enter, Escape, Backspace 동작

### 12.3 접근성 테스트 (수동)

- **Lighthouse 접근성 감사**: 95점 이상 목표
- **키보드 네비게이션**: 모든 기능 키보드로 접근 가능
- **스크린 리더 호환성**: NVDA, JAWS 테스트
- **ARIA 레이블 검증**: 모든 인터랙티브 요소 확인
- **색상 대비**: WCAG AA 기준 (4.5:1) 준수

### 12.4 브라우저 호환성 테스트 (수동)
- **Chrome**: 최신 버전 + 2개 이전 버전
- **Firefox**: 최신 버전 + 2개 이전 버전
- **Safari**: 최신 버전 (iOS 포함)
- **Edge**: 최신 버전

---

## 13. 배포 및 유지보수

### 13.1 배포 환경
- **GitHub Pages**: 정적 호스팅
- **Vercel/Netlify**: 자동 배포 파이프라인
- **CDN**: 정적 자산 캐싱

### 13.2 버전 관리
- **Semantic Versioning**: v1.0.0
- **Git**: 소스 코드 관리
- **Changelog**: 버전별 변경사항 문서화

### 13.3 모니터링
- **Google Analytics** (선택사항): 사용 패턴 분석
- **Sentry** (선택사항): 에러 추적
- **Lighthouse**: 성능 점수 모니터링

---

## 14. 향후 로드맵

### Phase 1 (MVP) - v1.0.0
- ✅ 기본 계산 기능
- ✅ 공학용 함수 (sin, cos, tan)
- ✅ 다크/라이트 모드
- ✅ 반응형 디자인

### Phase 2 - v1.1.0
- 계산 히스토리 구현
- 단위 변환 기능
- 메모리 기능 (M+, M-, MR, MC)
- 설정 패널 (소수점 자릿수, 테마 등)

### Phase 3 - v1.2.0
- 추가 과학 함수 (log, ln, exp, √, x², x³)
- 역삼각함수 (arcsin, arccos, arctan)
- 쌍곡선 함수 (sinh, cosh, tanh)
- 복소수 계산

### Phase 4 - v2.0.0
- PWA 변환 (오프라인 지원)
- 그래프 플로팅 기능
- 방정식 풀이
- 행렬 계산

---

## 15. 성공 지표 (KPI)

### 15.1 사용자 지표
- **일일 활성 사용자 (DAU)**: 목표 1,000명 (6개월 후)
- **평균 세션 시간**: 3-5분
- **재방문율**: 40% 이상

### 15.2 기술 지표
- **Lighthouse 성능 점수**: 90점 이상
- **접근성 점수**: 95점 이상
- **First Contentful Paint**: < 1.5초
- **Time to Interactive**: < 3초

### 15.3 품질 지표
- **버그 발생률**: < 0.1% (사용자당)
- **계산 정확도**: 99.99%
- **브라우저 호환성**: 95% 이상 지원

---

## 16. 리스크 및 완화 전략

### 16.1 기술적 리스크
| 리스크 | 영향도 | 완화 전략 |
|--------|--------|-----------|
| 부동소수점 오차 | 중 | 정밀도 라이브러리 사용 (decimal.js) |
| 브라우저 호환성 | 중 | Polyfill 적용, 크로스 브라우저 테스트 |
| 성능 저하 | 낮 | 코드 최적화, 디바운싱 |

### 16.2 사용자 경험 리스크
| 리스크 | 영향도 | 완화 전략 |
|--------|--------|-----------|
| 복잡한 UI | 중 | 사용자 테스트, 튜토리얼 제공 |
| 모바일 터치 오류 | 중 | 버튼 크기 최적화 (최소 44×44px) |
| 접근성 부족 | 낮 | WCAG 가이드라인 준수 |

---

## 17. 참고 자료

### 17.1 디자인 레퍼런스
- **파일**: `stitch_extracted/screen.png` - UI 디자인 목업
- **코드**: `stitch_extracted/code.html` - HTML/CSS 구현 예시

### 17.2 기술 문서
- [Tailwind CSS Documentation](https://tailwindcss.com/docs)
- [Material Symbols Guide](https://fonts.google.com/icons)
- [MDN Web Docs - Math](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Math)

### 17.3 유사 프로젝트
- Google Calculator
- iOS Calculator
- Windows Calculator

---

## 18. 부록

### 18.1 용어 정의
- **DEG**: Degree (도) - 각도 측정 단위
- **RAD**: Radian (라디안) - 각도 측정 단위 (π = 180°)
- **PWA**: Progressive Web App - 오프라인 지원 웹 앱
- **ARIA**: Accessible Rich Internet Applications - 접근성 표준

### 18.2 수학 함수 명세

| 함수 | 설명 | 입력 범위 | 출력 범위 |
|------|------|-----------|-----------|
| sin(x) | 사인 | -∞ ~ ∞ | -1 ~ 1 |
| cos(x) | 코사인 | -∞ ~ ∞ | -1 ~ 1 |
| tan(x) | 탄젠트 | x ≠ 90° + n×180° | -∞ ~ ∞ |
| √x | 제곱근 | x ≥ 0 | x ≥ 0 |
| x² | 제곱 | -∞ ~ ∞ | x ≥ 0 |
| log(x) | 상용로그 | x > 0 | -∞ ~ ∞ |
| ln(x) | 자연로그 | x > 0 | -∞ ~ ∞ |

---

## 문서 정보
- **작성일**: 2025-12-23
- **버전**: 1.0
- **작성자**: Antigravity AI
- **상태**: Draft (검토 필요)
